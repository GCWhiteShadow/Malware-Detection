from autoencoder import AutoEncoder
from classifier import Classifier
from util import *
import tensorflow as tf


def input_code():
    return code

data = import_data('../features.csv')
# estimator = tf.estimator.DNNClassifier(feature_columns=data[:, :1], hidden_units=[64, 32])

ae = AutoEncoder('../features.csv', 1742, [512, 128], epoch=300)

code = ae.train(data[:, 1:])

# estimator.train(input_code(), steps=500)


classifier = Classifier(code, data[:, 0:1], 128, [32, 1], 2)
classifier.train(step=1000)
